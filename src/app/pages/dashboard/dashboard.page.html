<ion-content [fullscreen]="true">
  <div class="dashboard-container">
    <!-- Welcome Section -->
    <div class="welcome-section">
      <div>
        <h1 class="welcome-title">¡Bienvenido de nuevo!</h1>
        <p class="welcome-subtitle">Continúa tu preparación para el examen Cambridge English</p>
      </div>
      <ion-button routerLink="/diagnostic" expand="block" class="diagnostic-button">
        Realizar Test Diagnóstico
        <ion-icon name="arrow-forward" slot="end"></ion-icon>
      </ion-button>
    </div>

    <!-- Progress Overview -->
    <ion-grid class="progress-overview">
      <ion-row>
        <ion-col size="12" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-subtitle>Nivel Estimado</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="stat-value">
                <ion-icon name="ribbon" color="primary"></ion-icon>
                <span>{{ progressData.level }}</span>
              </div>
              <p class="stat-description">First Certificate</p>
            </ion-card-content>
          </ion-card>
        </ion-col>

        <ion-col size="12" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-subtitle>Preguntas Completadas</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="stat-value">
                <ion-icon name="checkmark-circle" color="primary"></ion-icon>
                <span>{{ progressData.completedQuestions }}</span>
              </div>
              <p class="stat-description">De {{ progressData.totalQuestions }} recomendadas</p>
            </ion-card-content>
          </ion-card>
        </ion-col>

        <ion-col size="12" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-subtitle>Precisión</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="stat-value">
                <ion-icon name="locate" color="primary"></ion-icon>
                <span>{{ progressData.accuracy }}%</span>
              </div>
              <p class="stat-description">{{ progressData.correctAnswers }} respuestas correctas</p>
            </ion-card-content>
          </ion-card>
        </ion-col>

        <ion-col size="12" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-subtitle>Tiempo de Estudio</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="stat-value">
                <ion-icon name="time" color="primary"></ion-icon>
                <span>{{ progressData.studyTime }}h</span>
              </div>
              <p class="stat-description">En los últimos 30 días</p>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- Main Content -->
    <ion-grid>
      <ion-row>
        <!-- Left Column - Progress by Skill -->
        <ion-col size="12" size-lg="8">
          <ion-card class="skill-progress-card">
            <ion-card-header>
              <ion-card-title>Progreso por Habilidad</ion-card-title>
              <ion-card-subtitle>Tu rendimiento en cada área del examen</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="skill-progress-container">
                @for (skill of skillProgress; track skill) {
                  <div class="skill-item">
                    <div class="skill-header">
                      <span class="skill-name">{{ skill.name }}</span>
                      <span class="skill-value">{{ skill.value }}%</span>
                    </div>
                    <ion-progress-bar [value]="skill.value / 100" color="primary"></ion-progress-bar>
                  </div>
                }
              </div>
            </ion-card-content>
            <ion-card-content>
              <ion-button routerLink="/stats" expand="block" fill="outline">
                Ver Estadísticas Detalladas
                <ion-icon name="arrow-forward" slot="end"></ion-icon>
              </ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>

        <!-- Right Column - Quick Actions -->
        <ion-col size="12" size-lg="4">
          <ion-card class="quick-actions-card">
            <ion-card-header>
              <ion-card-title>Acciones Rápidas</ion-card-title>
              <ion-card-subtitle>Continúa tu preparación</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="quick-actions-container">
                @for (action of quickActions; track action) {
                  <ion-button
                    [routerLink]="action.href"
                    expand="block"
                    fill="outline"
                    class="action-button">
                    <ion-icon [name]="action.icon" slot="start"></ion-icon>
                    {{ action.name }}
                  </ion-button>
                }
              </div>
            </ion-card-content>
            <ion-card-content>
              <ion-button routerLink="/subscription" expand="block">
                Actualizar a Premium
              </ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <!-- Recent Activity and Progress Chart -->
      <ion-row>
        <!-- Recent Activity -->
        <ion-col size="12" size-lg="4">
          <ion-card class="recent-activity-card">
            <ion-card-header>
              <ion-card-title>Actividad Reciente</ion-card-title>
              <ion-card-subtitle>Tus últimas sesiones de estudio</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="activity-container">
                @for (activity of recentActivities; track activity) {
                  <div class="activity-item">
                    <div class="activity-icon">
                      <ion-icon [name]="activity.icon" color="primary"></ion-icon>
                    </div>
                    <div class="activity-content">
                      <h3 class="activity-title">{{ activity.title }}</h3>
                      <p class="activity-description">{{ activity.description }}</p>
                      <p class="activity-time">{{ activity.time }}</p>
                    </div>
                  </div>
                }
              </div>
            </ion-card-content>
            <ion-card-content>
              <ion-button routerLink="/activity" expand="block" fill="clear">
                Ver Todo el Historial
              </ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>

        <!-- Progress Chart -->
        <ion-col size="12" size-lg="8">
          <ion-card class="progress-chart-card">
            <ion-card-header>
              <ion-card-title>Progreso en el Tiempo</ion-card-title>
              <ion-card-subtitle>Tu evolución durante los últimos 6 meses</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="chart-container">
                <!-- Aquí se implementaría el gráfico con una librería como Chart.js -->
                <div class="chart-placeholder">
                  <p>Gráfico de progreso</p>
                </div>
              </div>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <!-- Recommended Practice -->
      <ion-row>
        <ion-col size="12">
          <ion-card class="recommended-practice-card">
            <ion-card-header>
              <ion-card-title>Práctica Recomendada</ion-card-title>
              <ion-card-subtitle>Basado en tu rendimiento, te recomendamos practicar estas áreas</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <ion-segment [(ngModel)]="selectedTab" (ionChange)="segmentChanged($event)">
                <ion-segment-button value="reading">
                  <ion-label>Reading</ion-label>
                </ion-segment-button>
                <ion-segment-button value="listening">
                  <ion-label>Listening</ion-label>
                </ion-segment-button>
                <ion-segment-button value="useOfEnglish">
                  <ion-label>Use of English</ion-label>
                </ion-segment-button>
                <ion-segment-button value="writing">
                  <ion-label>Writing</ion-label>
                </ion-segment-button>
                <ion-segment-button value="speaking">
                  <ion-label>Speaking</ion-label>
                </ion-segment-button>
              </ion-segment>

              <div class="practice-content">
                <div>
                  @switch (selectedTab) {
                    @case ('reading') {
                      <ion-grid>
                        <ion-row>
                          @for (practice of recommendedPractice.reading; track practice) {
                            <ion-col size="12" size-md="6">
                              <ion-card class="practice-card">
                                <ion-card-header>
                                  <ion-card-title>{{ practice.title }}</ion-card-title>
                                </ion-card-header>
                                <ion-card-content>
                                  <p>{{ practice.description }}</p>
                                  <ion-button [routerLink]="practice.href" expand="block" fill="outline" class="mt-3">
                                    Comenzar Práctica
                                  </ion-button>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          }
                        </ion-row>
                      </ion-grid>
                    }
                    @case ('listening') {
                      <ion-grid>
                        <ion-row>
                          @for (practice of recommendedPractice.listening; track practice) {
                            <ion-col size="12" size-md="6">
                              <ion-card class="practice-card">
                                <ion-card-header>
                                  <ion-card-title>{{ practice.title }}</ion-card-title>
                                </ion-card-header>
                                <ion-card-content>
                                  <p>{{ practice.description }}</p>
                                  <ion-button [routerLink]="practice.href" expand="block" fill="outline" class="mt-3">
                                    Comenzar Práctica
                                  </ion-button>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          }
                        </ion-row>
                      </ion-grid>
                    }
                    @case ('useOfEnglish') {
                      <ion-grid>
                        <ion-row>
                          @for (practice of recommendedPractice.useOfEnglish; track practice) {
                            <ion-col size="12" size-md="6">
                              <ion-card class="practice-card">
                                <ion-card-header>
                                  <ion-card-title>{{ practice.title }}</ion-card-title>
                                </ion-card-header>
                                <ion-card-content>
                                  <p>{{ practice.description }}</p>
                                  <ion-button [routerLink]="practice.href" expand="block" fill="outline" class="mt-3">
                                    Comenzar Práctica
                                  </ion-button>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          }
                        </ion-row>
                      </ion-grid>
                    }
                    @case ('writing') {
                      <ion-grid>
                        <ion-row>
                          @for (practice of recommendedPractice.writing; track practice) {
                            <ion-col size="12" size-md="6">
                              <ion-card class="practice-card">
                                <ion-card-header>
                                  <ion-card-title>{{ practice.title }}</ion-card-title>
                                </ion-card-header>
                                <ion-card-content>
                                  <p>{{ practice.description }}</p>
                                  <ion-button [routerLink]="practice.href" expand="block" fill="outline" class="mt-3">
                                    Comenzar Práctica
                                  </ion-button>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          }
                        </ion-row>
                      </ion-grid>
                    }
                    @case ('speaking') {
                      <ion-grid>
                        <ion-row>
                          @for (practice of recommendedPractice.speaking; track practice) {
                            <ion-col size="12" size-md="6">
                              <ion-card class="practice-card">
                                <ion-card-header>
                                  <ion-card-title>{{ practice.title }}</ion-card-title>
                                </ion-card-header>
                                <ion-card-content>
                                  <p>{{ practice.description }}</p>
                                  <ion-button [routerLink]="practice.href" expand="block" fill="outline" class="mt-3">
                                    Comenzar Práctica
                                  </ion-button>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          }
                        </ion-row>
                      </ion-grid>
                    }
                  }
                </div>
              </div>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>
